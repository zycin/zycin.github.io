<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" >

<title>Vuexä»‹ç» | Zycin | GeekBlog</title>
<meta name="description" content="ä¸å¿˜åˆå¿ƒ  æ–¹å¾—å§‹ç»ˆ">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://www.fastt.cn/favicon.ico?v=1571706063788">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://www.fastt.cn/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



</head>

<body>
  <div id="app" class="main">

    <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://www.fastt.cn">
        <img src="https://www.fastt.cn/images/avatar.png?v=1571706063788" class="site-logo">
        <h1 class="site-title">Zycin | GeekBlog</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/zycin/" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      ä¸å¿˜åˆå¿ƒ  æ–¹å¾—å§‹ç»ˆ
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/zycin" target="_blank">Zycin</a> | <a class="rss" href="https://www.fastt.cn/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


    <div class="main-container">
      <div class="content-container" data-aos="fade-up">
        <div class="post-detail">
          <h2 class="post-title">Vuexä»‹ç»</h2>
          <div class="post-date">2019-10-16</div>
          
          <div class="feature-container" style="background-image: url('https://www.fastt.cn/post-images/vuex.jpg')">
          </div>
          
          <div class="post-content">
            <p>å¤§è‡´äº†è§£äº†<strong>Vue</strong>ä¹‹å<br>
ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<strong>Vuex</strong><br>
begin enjoyğŸ‘‡</p>
<!-- more -->
<h3 id="vuexçš„ä½¿ç”¨"><code>vuex</code>çš„ä½¿ç”¨</h3>
<h4 id="vuexçš„åˆæ­¥è®¤è¯†å’Œä½¿ç”¨"><code>vuex</code>çš„åˆæ­¥è®¤è¯†å’Œä½¿ç”¨</h4>
<ul>
<li>
<p><code>vuex</code>æ˜¯ä¸€æ¬¾åŸºäº<code>vue</code>å¼€å‘çš„å¦ä¸€ä¸ªç¥ä½œæ¡†æ¶ï¼Œæ˜¯è¾…åŠ©<code>vue</code>çš„å…¨å±€æ•°æ®çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œ<code>vue</code>çš„ç‰¹ç‚¹å°±æ˜¯å•å‘æ•°æ®æµï¼Œå¯¼è‡´æœ‰äº›æ•°æ®çš„ä¼ é€’åªèƒ½ä»ä¸Šå¾€ä¸‹ä¸€ä¸ªä¸ªç»„ä»¶æ¥ä¼ é€’ï¼Œæˆ–è€…ä½¿ç”¨<code>$on</code>å’Œ<code>$emit</code>æ¥ä¼ é€’ï¼Œè¿™æ ·åˆ°åæœŸä¼šå¢åŠ <code>vue</code>é¡¹ç›®çš„ç®¡ç†éš¾åº¦ï¼Œå¯¼è‡´é¡¹ç›®è¿­ä»£ä¸æ–­å¤æ‚ï¼Œæœ€ç»ˆå†™åˆ°æ— æ³•ç»´æŠ¤çš„åœ°æ­¥è€Œåˆ°å´©æºƒè·‘è·¯ã€‚</p>
</li>
<li>
<p><code>vuex</code>æ˜¯é€šè¿‡<code>store</code>å¯¹è±¡æ¥è¿›è¡Œå…¨å±€æ•°æ®çŠ¶æ€ç®¡ç†çš„ï¼Œé€šè¿‡å°†<code>store</code>æ³¨å…¥åˆ°<code>vue</code>ä¸­åˆ°äº†ç»„ä»¶å¯ä»¥éšæ„ä½¿ç”¨æ•°æ®çš„ç›®çš„</p>
<pre><code class="language-javascript">Vue.use(Vuex);
const store = new Vuex.Store({
    state : {
        count : 0,
    }
});
new Vue({
    el:'#app',
    store,
    router,
    render:h=&gt;h(App),
});
</code></pre>
</li>
</ul>
<h4 id="vuexçš„stateæ¨¡å—"><code>vuex</code>çš„<code>state</code>æ¨¡å—</h4>
<ul>
<li>
<p><code>vuex</code>ä½¿ç”¨<strong>å•ä¸€çŠ¶æ€æ ‘</strong>ï¼Œç”¨ä¸€ä¸ªå¯¹è±¡å°±åŒ…å«äº†å…¨éƒ¨çš„åº”ç”¨å±‚çº§çŠ¶æ€ã€‚äºæ˜¯å®ƒä¾¿åšä¸ºäº†ä¸€ä¸ª<strong>å”¯ä¸€æ•°æ®æº</strong>ã€‚å› æ­¤åŸºäºä¸Šè¾¹çš„å®šä¹‰çš„<code>state</code>æ¨¡å—çš„ä½¿ç”¨ä¾¿å¯ä»¥åœ¨ä¸€ä¸ªç»„ä»¶ä¸­ç›´æ¥è·å–è¿™ä¸ªå€¼ï¼Œè€Œä¸”æ— è®ºæ˜¯è·¨äº†å¤šå°‘å±‚çº§çš„ç»„ä»¶ï¼Œåœ¨å“ªé‡Œéƒ½å¯ä»¥ç›´æ¥è·å–åˆ°ï¼Œæ“ä½œèµ·æ¥ååˆ†ç®€å•æ–¹ä¾¿</p>
<pre><code class="language-html">// Appç»„ä»¶
&lt;template&gt;
    &lt;div&gt;{{count}}&lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
	export default {
        data(){
            return {
                count:this.$store.state.count,
            };
        }
    }
&lt;/script&gt;
</code></pre>
</li>
<li>
<p>æœ€åå¯ä»¥ä½¿ç”¨<code>mapState</code>æ¥å°†<code>state</code>çš„å€¼ç›´æ¥æ˜ å°„åˆ°ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œå½“ç„¶åªèƒ½æ˜ å°„åˆ°<code>computed</code>æ¨¡å—æ¥ç”¨ç›¸å½“äºç›´æ¥é€šè¿‡<code>mapState</code>è·å–<code>state</code>é‡Œçš„å€¼æ¥ç”¨</p>
<pre><code class="language-html">// Appç»„ä»¶
&lt;template&gt;
    &lt;div&gt;
    	&lt;div&gt;{{count}}&lt;/div&gt;
		&lt;div&gt;{{getSum}}&lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
	export default {
        data(){
            return {
                num:100,
            };
        },
        computed:{
            ...mapState({
                count:state=&gt;state.count,
                getSum(state){
                    return this.num+state.count;
                },
            }),
        },
    }
&lt;/script&gt;
</code></pre>
</li>
</ul>
<h4 id="vuexä¸­çš„getteræ¨¡å—"><code>vuex</code>ä¸­çš„<code>getter</code>æ¨¡å—</h4>
<ul>
<li><code>state</code>ä¸­çš„æ•°æ®æœ‰æ—¶ä¸ä¼šæ˜¯é‚£ä¹ˆç®€å•çš„ä¸€ä¸ªæ•°æ®ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæ•°ç»„é›†åˆæ•°æ®ï¼Œäºæ˜¯ä¹è¦è·å–å…¶ä¸­æŸä¸ªæ•°æ®å€¼æ—¶çš„æ“ä½œå°±éœ€è¦å…ˆæ˜ å°„åˆ°ç»„ä»¶ä¸­ï¼Œç„¶åç”¨ä¸ª<code>model</code>æ¥æ¥æ”¶å†æ“ä½œï¼Œä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œé‚£ä¹ˆ<code>vuex</code>æä¾›äº†<code>getter</code>æ¨¡å—æ¥å¸®æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å…ˆé¢„ç½®å®šä¹‰å¥½è¦æ“ä½œ<code>state</code>çš„ä¸€äº›æ¡ä»¶å–å€¼æ–¹åï¼Œç›´æ¥è°ƒç”¨å³å¯ã€‚</li>
</ul>
<pre><code class="language-javascript">const store = new Vuex.Store({
    state:{
        persons:[
            {id:'1',name:'æç™½',age:18},
            {id:'2',name:'å¨œå¯éœ²éœ²',age:28},
            {id:'3',name:'ä¸çŸ¥ç«èˆ',age:38},
            {id:'4',name:'æ©˜å³äº¬',age:48},
            {id:'5',name:'å®«æœ¬æ­¦è—',age:58},
        ],
    },
    getters:{
        //é€šè¿‡å±æ€§è®¿é—®
        getPerson1(state){
            return state.persons.filter(item =&gt; item.age&gt;25);
        },
        //é€šè¿‡æ–¹æ³•è®¿é—®
        getPerson2:state =&gt; name =&gt; {
            return state.persons.find(item =&gt; item.name === 'æ©˜å³äº¬');
        },
    },
});
</code></pre>
<ul>
<li>é‚£ä¹ˆå®é™…åœ¨ç»„ä»¶ä¸­è¦ä½¿ç”¨äº†ï¼Œå¯ä»¥é€šè¿‡<code>this.$store.getters.getPerson1</code>æ¥è·å–<code>getters</code>ç­›é€‰çš„ç»“æœå³å¯</li>
<li>å¦‚æœæ˜¯é€šè¿‡æ–¹æ³•è®¿é—®çš„ï¼Œåˆ™éœ€è¦é…±ç´«è°ƒç”¨<code>this.$store.getters.getPerson2('æ©˜å³äº¬')</code></li>
<li>æœ€åä¸€ç§åœ¨ç»„ä»¶ä¸­çš„ç”¨æ³•å°±æ˜¯åˆ©ç”¨<code>mapGetters</code>å°†<code>getter</code>åˆ©ç”¨<code>ES6</code>çš„å±•å¼€è¿ç®—ç¬¦ï¼Œé“ç†å’Œ<code>mapState</code>ä¸€æ ·ï¼Œåœ¨ç»„ä»¶çš„<code>computed</code>æ¨¡å—é‡Œç›´æ¥æ˜ å°„ä½¿ç”¨å³å¯</li>
</ul>
<h4 id="vuexçš„mutationæ¨¡å—"><code>vuex</code>çš„<code>mutation</code>æ¨¡å—</h4>
<ul>
<li>ä¿®æ”¹<code>vuex</code>ä¸­çš„<code>store</code>ä¸­çš„<code>state</code>ä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•å°±æ˜¯é€šè¿‡<code>mutation</code>æ¨¡å—æ¥åšå¤„ç†æ‰è¡Œè¿™ä¸ªæ¨¡å—æ˜¯æ“ä½œ<code>state</code>çš„å”¯ä¸€é€”å¾„ï¼Œç±»ä¼¼<code>redux</code>é‡Œçš„<code>reducer</code>æ¨¡å—çš„ä½œç”¨ä¸€æ ·ï¼Œæ¯•ç«Ÿç…§æŠ„äºº<code>redux</code>çš„å˜›ï¼Œæ‰€ä»¥æ€»ç»“ä¸€ä¸‹å°±æ˜¯ä¸æ˜¯è®©ä½ è¯´æƒ³æ”¹å°±ä¹±æ”¹çš„ï¼Œè€Œæ˜¯éœ€è¦é€šè¿‡<code>mutation</code>æ¨¡å—æ¸ é“æ¥ä¿®æ”¹æ‰è¡Œã€‚</li>
</ul>
<pre><code class="language-javascript">state:{
    count:0,
},
mutations:{
    addOne(state){
        state.count++;
    }
},
</code></pre>
<ul>
<li>å¯¹äºä¸Šè¾¹ä»£ç ï¼Œå¯ä»¥ç›´æ¥åœ¨ç»„ä»¶å†…éƒ¨é€šè¿‡<code>@click</code>æ–¹æ³•ç‚¹å‡»æŸä¸ªæŒ‰é’®æ—¶ï¼Œè°ƒç”¨<code>this.$store.commit('addOne')</code>æ¥è°ƒç”¨ä¿®æ”¹<code>state</code>ï¼Œ<code>commit</code>æ˜¯è§¦å‘<code>mutation</code>æ¨¡å—çš„å”¯ä¸€å…³é”®å…¥å£æ–¹æ³•</li>
<li>ä½†æ˜¯ä¸€èˆ¬ä¿®æ”¹<code>state</code>æ—¶ï¼Œéƒ½ä¸ä¼šæŠŠè¦ä¿®æ”¹çš„å€¼å†™æ­»ï¼Œè€Œæ˜¯é€šè¿‡è½½è·<code>payload</code>æ¥è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ ·äº†é€šè¿‡æäº¤å¯¹è±¡å‚æ•°ï¼Œå¯ä»¥ä¿®æ”¹çš„æ›´åŠ çµæ´»</li>
</ul>
<pre><code class="language-javascript">state:{
    count:0,
    obj:{
        name:'æç™½',
    },
},
mutations:{
    addOne(state,payload){
        state.count+=payload.num;
    }
},
</code></pre>
<ul>
<li>è¿™æ ·äº†ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡<code>commit</code>æ¥é…±ç´«æäº¤ï¼Œ<code>this.$store.commit('addOne',{num:10})</code></li>
<li>ä½†æ˜¯è¿™æ ·æäº¤å¾ˆæ²¡é£æ ¼ï¼Œå› æ­¤<code>vuex</code>ä¹Ÿå­¦äº†<code>redux</code>é‚£æ ·è¿›è¡Œäº†å¯¹è±¡é£æ ¼çš„æäº¤æ–¹å¼æ¥æ“ä½œthis.$store.commit({type:'addOne',num:10})</li>
<li>å¦‚æœè¦å¯¹<code>state</code>é‡ŒæŸä¸ªå¯¹è±¡è¿›è¡Œæ–°å±æ€§æ‰©å±•äº†ï¼Œ<code>vue</code>è™½ç„¶æä¾›äº†<code>set</code>æ–¹æ³•ï¼Œä½†åˆ©ç”¨<code>ES6</code>å¯ä»¥è®©äº‹æƒ…æ›´åŠ ç®€å•ï¼Œç”¨å¦‚ä¸‹ä»£ç æ“ä½œå³å¯ï¼Œ<code>this.$store.state.obj={...this.$store.state.objage:18</code></li>
<li>å› ä¸ºå¯ä»¥ç›´æ¥åˆ©ç”¨å¯¹è±¡é£æ ¼åŒ–æ–¹å¼æ¥æäº¤<code>mutation</code>æ¨¡å—ä¿®æ”¹<code>state</code>ï¼Œæ‰€ä»¥åœ¨ä¸€äº›ä¸­å¤§å‹é¡¹ç›®ä¸­å¾€å¾€ä¸ç›´æ¥å°†<code>mutation</code>æ¨¡å—çš„åå­—å®šä¹‰é‚£ä¹ˆæ­»æ¿ï¼Œè€Œæ˜¯åˆ©ç”¨<code>actions</code>æ¥å®šä¹‰<code>mutation</code>ï¼Œè¿™æ ·åšçš„ç›®çš„å°±æ˜¯å¢å¼ºä»£ç çš„é˜…è¯»æ€§ï¼Œåˆ©äºå…¶ä»–äººä»‹å…¥é¡¹ç›®å¼€å‘å’Œæ›´æœ‰æ•ˆçš„åˆ©ç”¨<code>mutation</code>æ¨¡å—</li>
</ul>
<pre><code class="language-javascript">import {ADD_ONE} from './mutation-actions';
state:{
    count:0,
    obj:{
        name:'æç™½',
    },
},
mutations:{
    //ä¾ç„¶æ˜¯åˆ©ç”¨ES6è¯­æ³•çš„å¼ºåŒ–å­—é¢é‡æ–¹å¼ï¼Œå¢åŠ ä»£ç å¯è¯»æ€§æ¥ä¸€èµ·ç»´æŠ¤mutation
    //è¿™æ ·åšä¸æ˜¯ä½ å–œä¸å–œæ¬¢çš„é—®é¢˜ï¼Œè€Œæ˜¯ä½ çš„å¤§ä½¬åˆ¶å®šçš„é¡¹ç›®å¼€å‘çš„è§„èŒƒæ¥ä½¿ç”¨
    [ADD_ONE](state,payload){
        state.count += payload.num;
    }
},
</code></pre>
<ul>
<li>æ³¨æ„ï¼š<code>mutation</code>æ¨¡å—çš„ä»£ç éƒ½æ˜¯<strong>çº¯å‡½æ•°</strong>ä»£ç ï¼Œæ‰€è°“<strong>çº¯å‡½æ•°</strong>çš„æ„æ€å°±æ˜¯å¿…é¡»æ˜¯åŒæ­¥ä»£ç æ¨¡å—ï¼é»˜è®¤çš„<code>mutation</code>æ¨¡å—æ˜¯ä¸æ”¯æŒå¼‚æ­¥ä»£ç æ¨¡å—çš„ï¼Œè¦æƒ³å¼‚æ­¥åŒ–æ“ä½œï¼Œåœ¨åè¾¹çš„<code>action</code>æ¨¡å—ä¸­ä¼šè®²è§£åˆ°</li>
<li>æœ€åå°±æ˜¯åœ¨<code>methods</code>æ¨¡å—ä¸­é€šè¿‡<code>mapMutations</code>æ¥æ˜ å°„<code>mutation</code>æ¨¡å—çš„æ“ä½œ</li>
</ul>
<pre><code class="language-javascript">import { mapMutations } from 'vuex';
export default {
    methods:{
        ...mapMutations([
            //å°†this.addOne()æ–¹æ³•æ˜ å°„ä¸ºthis.$store.commit({type:'addOne',num:10})
            'addOne'
        ]),
        ...mapMutations({
            //å°†this.add()æ–¹æ³•æ˜ å°„ä¸ºthis.$store.commit({type:'addOne',num:10})
            //è·Ÿä¸Šè¾¹çš„å·®ä¸å¤šä¸€æ ·ï¼Œåªæ˜¯å¤šèµ·äº†ä¸ªkeyåæ¥åšä¸ºæ˜ å°„çš„ä»£è¡¨ç½¢äº†
            add:'addOne',
        }),
    }
}
</code></pre>
<hr>
<p align="right">posted @ Zycin (éè½¬è½½ æ¥è‡ªä¸ªäººå­¦ä¹ èµ„æ–™æ•´ç†)</p>

          </div>
          
          <div class="tag-container">
            
            <a href="https://www.fastt.cn/tag/vue" class="tag">
              vue
            </a>
            
          </div>
          


          
          <div class="next-post">
            
            
            <div class="next">
              <div class="post-page">ä¸‹ä¸€ç¯‡</div>
              <a href="https://www.fastt.cn/post/Vue4">
                <h3 class="post-title">
                  Vueç¬¬å››æ®µ
                </h3>
              </a>
            </div>
            
          </div>
          

          
          
          <div id="gitalk-container" data-aos="fade-in"></div>
          

          
          

        </div>

      </div>
    </div>
  </div>

  <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: 'f9c4cb98113788bb94e1',
        clientSecret: 'd271ed343d3af9b71c24dff543d9c3e1e4d70a4b',
        repo: 'zycin.github.io',
        owner: 'zycin',
        admin: ['zycin'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




</body>

</html>